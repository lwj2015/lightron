{
    "distributed": {
        "tp_size": 2,
        "dp_size": 4,
        "pp_size": 1,
        "cp_size": 1,
        "ep_size": 1
    },
    "model": {
        "name": "gpt2",
        "moe_num_experts": 1,
        "moe_topk": 2
    },
    "dataset": {
        "name": "roneneldan/TinyStories",
        "split": "train",
        "num_workers": 0
    },
    "training": {
        "micro_batch_size": 4,
        "gradient_accumulation_steps": 2,
        "seq_length": 128,
        "learning_rate": 3e-4,
        "weight_decay": 0.01,
        "total_steps": 50,
        "log_interval": 5,
        "max_samples": 5000
    }
}
